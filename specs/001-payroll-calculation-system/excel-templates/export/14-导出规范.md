# 薪资数据导出格式说明

## 概述

本文档详细说明PayrollMaster薪资自动核算系统的数据导出格式。系统支持多种格式的薪资报表导出，满足不同的业务需求。

## 导出模板文件

### dataExportReport.xlsx
**用途**: 数据导出模板，用于导出员工基础信息
**工作表**: Sheet1
**参考文件**: `dataExportReport.xlsx`（已提供，11KB）

该模板包含员工基础信息字段，用于导出员工基础数据。

### payrollCalculationResultExportReport.xlsx
**用途**: 薪资计算结果导出模板，用于导出完整的薪资计算结果
**工作表**: 数据写入到`payrollCalculationResult`工作表中
**参考文件**: `payrollCalculationResultExportReport.xlsx`（已提供，175KB）

该模板包含了完整的薪资计算结果字段，支持导出所有员工的薪资明细和汇总信息。

## 导出文件类型

### 1. 员工基础信息导出 (dataExportReport.xlsx)
**用途**: 提供员工基础信息，便于查看和导出
**适用场景**: 员工信息统计、部门人员查询

### 2. 薪资计算结果表 (payrollCalculationResultExportReport.xlsx)
**用途**: 提供完整的薪资计算结果，包括所有计算明细和最终结果
**工作表**: payrollCalculationResult
**适用场景**: 薪资发放、财务审计、数据分析

## 薪资汇总表结构

### 基本信息区

| 列序号 | 列名称 | 数据类型 | 说明 | 示例 |
|--------|--------|----------|------|------|
| A | 员工编码 | 字符串 | 员工唯一标识 | EMP001 |
| B | 员工姓名 | 字符串 | 员工真实姓名 | 张三 |
| C | 部门编码 | 字符串 | 部门唯一标识 | DEP001 |
| D | 部门名称 | 字符串 | 部门名称 | 技术部 |
| E | 工资薪制 | 字符串 | 日薪或月薪 | 日薪 |
| F | 集团工龄 | 正整数 | 在集团工作年限 | 5 |
| G | 入井年限 | 正整数 | 井下工作年限 | 3 |

### 考勤统计区

| 列序号 | 列名称 | 数据类型 | 说明 | 示例 |
|--------|--------|----------|------|------|
| H | 制度工日工数 | 正整数 | 制度内工作天数 | 21 |
| I | 加班工数 | 正整数 | 公休和节假日加班总天数 | 3 |
| J | 带薪假工数 | 正整数 | 各类带薪假期总天数 | 5 |
| K | 下井工数 | 正整数 | 井下工作天数 | 20 |
| L | 夜班工数 | 正整数 | 夜班工作天数 | 10 |

### 薪资构成区

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 | 示例 |
|--------|--------|----------|------|----------|------|
| M | 岗位工资 | 浮点数 | 基础岗位工资 | 见计算规则 | 3500.00 |
| N | 井下职业健康岗位工资 | 浮点数 | 井下工作补贴 | 岗位工资×(系数-1) | 700.00 |
| O | 年功工资 | 正整数 | 按工龄计算的工资 | 按工龄标准表 | 400.00 |
| P | 加班工资合计 | 浮点数 | 加班费总计 | 日资×公休×2+日资×节假日×3 | 600.00 |
| Q | 带薪假类工资合计 | 浮点数 | 各类带薪假工资 | 按假期类型计算 | 800.00 |
| R | 辅助工资合计 | 正整数 | 各类津贴补贴 | 各类津贴之和 | 1500.00 |
| S | 绩效工资合计 | 浮点数 | 绩效相关工资 | 分配+补发+计件 | 1000.00 |
| T | 奋斗者专项激励 | 正整数 | 专项奖励 | 直接取值 | 500.00 |
| U | 贡献收入 | 正整数 | 贡献奖励 | 直接取值 | 300.00 |
| V | 扣罚工资 | 数值 | 扣罚金额（负数） | 直接取值 | -200.00 |

### 汇总区

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 | 示例 |
|--------|--------|----------|------|----------|------|
| W | 应领工资 | 浮点数 | 税前应发工资 | M到V列之和 | 8100.00 |
| X | 个人代扣代缴合计 | 浮点数 | 个人社保公积金等 | 各扣款项之和 | 1200.00 |
| Y | 个人所得税 | 浮点数 | 个人所得税 | 直接取值 | 350.00 |
| Z | 独生子女费 | 正整数 | 独生子女补贴 | 直接取值 | 0.00 |
| AA | 女工卫生费 | 正整数 | 女职工补贴 | 直接取值 | 30.00 |
| AB | 实领工资 | 浮点数 | 最终实发工资 | W-X-Y+Z+AA | 6680.00 |

## 薪资明细表结构

### 基本信息区 (A-G列)
与薪资汇总表相同

### 考勤明细区 (H-AE列)

| 列序号 | 列名称 | 数据类型 | 说明 | 备注 |
|--------|--------|----------|------|------|
| H | 制度工日工数 | 正整数 | 制度内工作天数 | - |
| I | 公出工数 | 正整数 | 公出工作天数 | - |
| J | 学习工数 | 正整数 | 培训学习天数 | - |
| K | 带薪年休假 | 正整数 | 年休假天数 | - |
| L | 婚假 | 正整数 | 婚假天数 | - |
| M | 探亲假 | 正整数 | 探亲假天数 | - |
| N | 有资产假 | 正整数 | 有资假期天数 | - |
| O | 哺乳假 | 正整数 | 哺乳假天数 | - |
| P | 丧假 | 正整数 | 丧假天数 | - |
| Q | 病假 | 正整数 | 病假天数 | - |
| R | 其他有资假 | 正整数 | 其他有资假天数 | - |
| S | 其他有资假工资 | 正整数 | 其他有资假工资 | - |
| T | 有资假备注 | 字符串 | 有资假说明 | - |
| U | 事假 | 正整数 | 事假天数 | - |
| V | 旷工 | 正整数 | 旷工天数 | - |
| W | 下井工数 | 正整数 | 井下工作天数 | - |
| X | 前夜班工数 | 正整数 | 前夜班天数 | - |
| Y | 后夜班工数 | 正整数 | 后夜班天数 | - |
| Z | 地面生产夜班工数 | 正整数 | 地面生产夜班天数 | - |
| AA | 地面非生产夜班工数 | 正整数 | 地面非生产夜班天数 | - |
| AB | 值班天数 | 正整数 | 值班天数 | - |

### 加班考勤区 (AF-AK列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| AC | 公休日出勤工数 | 正整数 | 公休日加班天数 |
| AD | 节假日出勤工数 | 正整数 | 节假日加班天数 |
| AE | 有资假工数 | 正整数 | 有资假总天数 |

### 绩效津贴区 (AL-AR列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| AF | 绩效分配金额 | 正整数 | 绩效分配 |
| AG | 绩效补发金额 | 正整数 | 绩效补发 |
| AH | 考核奖扣工资 | 数值 | 考核奖励或扣罚 |
| AI | 井下折算调整工龄 | 正整数 | 井下折算工龄 |
| AJ | 值班津贴标准 | 正整数 | 值班津贴标准 |
| AK | 入井津贴标准 | 正整数 | 入井津贴标准 |
| AL | 保留工资 | 正整数 | 保留工资 |

### 各项津贴区 (AS-BB列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| AM | 补差工资 | 正整数 | 补差工资 |
| AN | 高温高空津贴 | 正整数 | 高温高空补贴 |
| AO | 野外施工津贴 | 正整数 | 野外施工补贴 |
| AP | 有毒有害津贴 | 正整数 | 有毒有害补贴 |
| AQ | 电焊津贴 | 正整数 | 电焊补贴 |
| AR | 回族伙食津贴 | 正整数 | 回族伙食补贴 |
| AS | 交通补助 | 正整数 | 交通补贴 |
| AT | 通讯补助 | 正整数 | 通讯补贴 |
| AU | 其他津补贴 | 正整数 | 其他补贴 |

### 计件奖励区 (BC-BE列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| AV | 工分 | 正整数 | 计件工分 |
| AW | 单价 | 浮点数 | 计件单价 |
| AX | 计件工资 | 浮点数 | 计件工资总额 |

### 奖励扣罚区 (BF-BG列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| AY | 奋斗者专项激励 | 正整数 | 专项激励 |
| AZ | 贡献收入 | 正整数 | 贡献收入 |

### 扣罚区 (BH-BI列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| BA | 扣罚工资 | 数值 | 扣罚工资（可为负） |
| BB | 扣罚工资备注 | 字符串 | 扣罚说明 |

### 计算明细区 (BJ-BR列)

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 |
|--------|--------|----------|------|----------|
| BC | 日资 | 浮点数 | 日薪标准 | 岗位工资基值×岗位系数×专业技术人员岗位调节系数÷基础制度日工数(21.75) |
| BD | 岗位工资 | 浮点数 | 岗位工资 | 日资×制度工日工数 |
| BE | 井下职业健康岗位工资 | 浮点数 | 井下补贴 | 岗位工资×(系数-1) |
| BF | 年功工资 | 正整数 | 年功工资 | 按工龄标准表 |
| BG | 加班工资合计 | 浮点数 | 加班费 | 日资×公休日出勤工数×2+日资×节假日出勤工数×3 |
| BH | 年休假工资 | 浮点数 | 年休假工资 | 日资×带薪年休假 |
| BI | 培训工资 | 浮点数 | 培训工资 | 日资×学习工数 |
| BJ | 婚假工资 | 浮点数 | 婚假工资 | 日资×婚假 |
| BK | 探亲假工资 | 浮点数 | 探亲假工资 | 日资×探亲假 |

### 假期工资区 (BS-BZ列)

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 |
|--------|--------|----------|------|----------|
| BL | 有资产假工资 | 浮点数 | 有资假工资 | 日资×有资产假 |
| BM | 丧假工资 | 浮点数 | 丧假工资 | 日资×丧假 |
| BN | 病假工资 | 浮点数 | 病假工资 | 日资×病假×病假系数 |
| BO | 下井津贴 | 正整数 | 下井津贴 | 下井工数×入井津贴标准 |
| BP | 夜班津贴 | 正整数 | 夜班津贴 | 前夜班×18+后夜班×20 |
| BQ | 值班津贴 | 正整数 | 值班津贴 | 值班天数×值班津贴标准 |
| BR | 带薪假类工资合计 | 浮点数 | 带薪假工资总计 | BH到BN列之和 |
| BS | 辅助工资合计 | 正整数 | 辅助工资总计 | 各类津贴之和 |

### 绩效汇总区 (CA-CB列)

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 |
|--------|--------|----------|------|----------|
| BT | 绩效工资合计 | 浮点数 | 绩效工资总计 | 绩效分配+绩效补发+考核奖扣+计件工资 |
| BU | 应领工资 | 浮点数 | 税前应发工资 | BD到BT列+激励+贡献-扣罚 |

### 扣款项区 (CC-CG列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| BV | 养老保险（个人） | 浮点数 | 个人养老保险 |
| BW | 医疗保险（个人） | 浮点数 | 个人医疗保险 |
| BX | 失业保险（个人） | 浮点数 | 个人失业保险 |
| BY | 住房公积金（个人） | 正整数 | 个人住房公积金 |
| BZ | 个人所得税 | 浮点数 | 个人所得税 |
| CA | 个人代扣代缴合计 | 浮点数 | 个人扣款总计 |

### 税后项目区 (CB-CC列)

| 列序号 | 列名称 | 数据类型 | 说明 |
|--------|--------|----------|------|
| CB | 独生子女费 | 正整数 | 独生子女费 |
| CC | 女工卫生费 | 正整数 | 女工卫生费 |

### 最终汇总区 (CD列)

| 列序号 | 列名称 | 数据类型 | 说明 | 计算公式 |
|--------|--------|----------|------|----------|
| CD | 实领工资 | 浮点数 | 最终实发工资 | 应领工资-个人代扣代缴合计-个人所得税+独生子女费+女工卫生费 |

## 导出格式要求

### 文件格式
- **文件类型**: `.xlsx` (Excel 2007及以上版本)
- **编码格式**: UTF-8
- **工作表**: 默认工作表名为"薪资报表"，支持自定义

### 数据格式
- **数值精度**: 金额保留2位小数，系数保留1-2位小数
- **日期格式**: YYYY-MM-DD
- **空值处理**: 空单元格显示为空字符串或0

### 样式设置
- **表头样式**: 加粗，背景色为浅蓝色 (#E6F2FF)
- **数据行**: 交替行背景色 (#F8F9FA)
- **边框**: 所有单元格添加细线边框
- **列宽**: 自动调整列宽，最小宽度10

## 筛选和排序

### 支持的筛选操作
1. **按部门筛选**: 可以筛选特定部门的数据
2. **按工资范围筛选**: 可以筛选指定工资范围的数据
3. **按工龄筛选**: 可以筛选指定工龄范围的数据
4. **多条件组合筛选**: 支持多个条件同时筛选

### 支持的排序操作
1. **按员工编码排序**: 升序或降序
2. **按部门排序**: 按部门名称字母序
3. **按实发工资排序**: 按金额升序或降序
4. **多列排序**: 支持多列组合排序

## 导出选项

### 1. 完整导出
导出所有员工的完整薪资数据（汇总表或明细表）

### 2. 按部门导出
只导出指定部门的员工数据

### 3. 按条件导出
根据筛选条件导出符合条件的数据

### 4. 汇总导出
只导出汇总信息，不包含明细数据

### 5. 对比导出
导出两个时期的薪资数据，便于对比分析

## 文件命名规则

根据导出文件类型的不同，采用以下命名规则：

### 1. 基础数据提报表 (dataExportReport.xlsx)

**用途**：导出部门薪资计算的原始基础数据，仅在部门薪资计算完成且系统管理员审核通过后可导出

**命名格式**：
```
YYYYMM[部门名称]数据提报表.xlsx
```

**示例**：
- `202412技术部数据提报表.xlsx`
- `202412市场部数据提报表.xlsx`
- `202411行政部数据提报表.xlsx`

### 2. 薪资明细表 (payrollCalculationResultExportReport.xlsx)

**用途**：导出员工薪资计算的详细结果，仅在部门薪资计算完成且系统管理员审核通过后可导出

**命名格式**：
```
YYYYMM[部门名称]薪资明细表.xlsx
```

**示例**：
- `202412技术部薪资明细表.xlsx`
- `202412市场部薪资明细表.xlsx`
- `202411财务部薪资明细表.xlsx`

### 3. 命名规则说明

| 参数 | 说明 | 格式 | 示例 |
|------|------|------|------|
| YYYYMM | 数据对应的年月 | YYYYMM（6位数字） | `202412`（2024年12月） |
| 部门名称 | 指定部门标识 | 中文（不使用特殊字符） | `技术部` / `市场部` |
| 报表类型标识 | 固定的后缀标识 | 中文 | `数据提报表` / `薪资明细表` |

### 4. 命名约束

- **年月格式**：必须使用YYYYMM（6位数字）格式，例如202412表示2024年12月
- **部门名称**：使用UTF-8编码的中文部门名称，不包含特殊字符（如空格、标点等）
- **文件扩展名**：统一使用`.xlsx`
- **导出权限**：只有薪资计算完成并经系统管理员审核通过后，方可导出上述报表
- **文件名长度**：总长度不超过255个字符（Excel文件命名限制）

### 5. 注意事项

- 部门名称必须与系统中定义的部门名称完全一致
- 年月格式必须为薪资数据对应的实际年月
- 文件名中的中文字符使用全角字符，不使用半角字符

## 安全性要求

1. **数据脱敏**: 导出文件中不包含身份证号等敏感信息
2. **访问控制**: 只有有权限的用户才能导出数据
3. **操作日志**: 所有导出操作都会被记录到系统日志中
4. **数据加密**: 敏感数据传输时进行加密处理

## 注意事项

1. **数据一致性**: 导出数据必须与系统计算结果一致
2. **性能考虑**: 大量数据导出时，系统会采用分批处理方式
3. **文件大小**: 单次导出的数据量建议不超过10000条记录
4. **版本兼容**: 导出的Excel文件必须能被Excel 2016及以上版本正常打开
