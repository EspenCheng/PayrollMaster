# 薪资数据导入格式说明

## 概述

本文档详细说明PayrollMaster薪资自动核算系统的数据导入格式要求。所有导入的Excel文件必须符合本规范才能被系统正确处理。

## 导入模板文件

### dataSubmissionReport.xlsx
**用途**: 数据提报模板，用于导入员工基础信息和考勤数据
**工作表**: 默认工作表名为"Sheet1"，数据从第2行开始
**参考文件**: `dataSubmissionReport.xlsx`（已提供，143KB）

该模板包含了完整的员工基础信息和考勤数据字段，支持批量导入薪资计算所需的全部数据。

## 文件要求

### 文件格式
- 支持格式：`.xlsx`、`.xls`
- 文件大小：最大50MB
- 编码格式：UTF-8

### Excel表格结构
- **工作表名称**: 默认为"Sheet1"，支持自定义
- **表头行**: 第1行必须是字段名称（表头）
- **数据行**: 从第2行开始为实际数据
- **空行处理**: 系统会自动跳过空行

## 字段定义

### 必填字段 (Required Fields)

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 验证规则 | 示例 |
|------|----------|-------------|----------|----------|------|
| 1 | 员工编码 | mdnb_employee.number | 字符串 | 非空且唯一 | EMP001 |
| 2 | 员工姓名 | mdnb_employee.name | 字符串 | 非空 | 张三 |
| 3 | 身份证号 | mdnb_idcard1 | 字符串 | 身份证格式验证 | 110101199001011234 |
| 4 | 原系统员工ID | mdnb_sourceuserid | 字符串 | 数字字符串 | 12345 |
| 5 | 部门编码 | mdnb_department.number | 字符串 | 非空 | DEP001 |
| 6 | 部门名称 | mdnb_department.name | 字符串 | 非空 | 技术部 |
| 7 | 部门类别 | department_classification | 字符串 | 非空 | 生产部门 |
| 8 | 部门二级类别 | sub_department | 字符串 | 非空 | 井下作业 |
| 9 | 岗位工种 | mdnb_employee.job | 字符串 | 非空 | 矿工 |
| 10 | 岗位类别 | mdnb_employee.job_type | 字符串 | 非空 | 操作工 |
| 11 | 职务类别 | mdnb_employee.post | 字符串 | 非空 | 员工 |
| 12 | 集团工龄 | mdnb_employee.seniority | 正整数 | ≥0 | 5 |
| 13 | 入井年限 | mdnb_employee.undergroundWorkYears | 正整数 | ≥0 | 3 |
| 14 | 工资薪制 | mdnb_textfield1 | 字符串 | '日薪'或'月薪' | 日薪 |
| 15 | 岗位工资基值 | mdnb_amountfield2 | 正整数 | ≥0 | 700 |
| 16 | 岗位系数 | mdnb_decimalfield1 | 浮点数 | 1.0-6.0 | 1.5 |
| 17 | 专业技术人员岗位调节系数 | mdnb_decimalfield2 | 数值 | 1.0或1.1或1.2 | 1.1 |
| 18 | 井下职业健康岗位工资系数 | mdnb_decimalfield3 | 数值 | 1.0或1.2或1.4或1.6或1.8 | 1.2 |
| 19 | 年功工资标准 | mdnb_textfield2 | 字符串 | '新标准'或'旧标准' | 新标准 |

### 可选字段 (Optional Fields)

#### 考勤数据

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 20 | 制度工日工数 | mdnb_decimalfield5 | 正整数 | 0 | 0-25 |
| 21 | 公出工数 | mdnb_decimalfield22 | 正整数 | 0 | 0-25 |
| 22 | 学习工数 | mdnb_decimalfield19 | 正整数 | 0 | 0-25 |
| 23 | 带薪年休假 | mdnb_decimalfield8 | 正整数 | 0 | 0-15 |
| 24 | 婚假 | mdnb_decimalfield9 | 正整数 | 0 | 0-25 |
| 25 | 探亲假 | mdnb_decimalfield14 | 正整数 | 0 | 0-25 |
| 26 | 有资产假 | mdnb_decimalfield10 | 正整数 | 0 | 0-25 |
| 27 | 哺乳假 | mdnb_decimalfield17 | 正整数 | 0 | 0-25 |
| 28 | 丧假 | mdnb_decimalfield13 | 正整数 | 0 | 0-25 |
| 29 | 病假 | mdnb_decimalfield12 | 正整数 | 0 | 0-25 |
| 30 | 其他有资假 | mdnb_decimalfield20 | 正整数 | 0 | 0-25 |
| 31 | 其他有资假工资 | mdnb_amountfield4 | 正整数 | 0 | ≥0 |
| 32 | 有资假备注 | mdnb_textfield5 | 字符串 | 空 | - |
| 33 | 事假 | mdnb_decimalfield18 | 正整数 | 0 | 0-25 |
| 34 | 旷工 | mdnb_decimalfield21 | 正整数 | 0 | 0-25 |
| 35 | 下井工数 | mdnb_decimalfield26 | 正整数 | 0 | 0-31 |
| 36 | 前夜班工数 | mdnb_decimalfield27 | 正整数 | 0 | 0-31 |
| 37 | 后夜班工数 | mdnb_decimalfield24 | 正整数 | 0 | 0-31 |
| 38 | 地面生产夜班工数 | mdnb_decimalfield28 | 正整数 | 0 | 0-31 |
| 39 | 地面非生产夜班工数 | mdnb_decimalfield25 | 正整数 | 0 | 0-31 |
| 40 | 值班天数 | mdnb_decimalfield29 | 正整数 | 0 | 0-31 |
| 41 | 公休日出勤工数 | mdnb_decimalfield7 | 正整数 | 0 | 0-4 |
| 42 | 节假日出勤工数 | mdnb_decimalfield11 | 正整数 | 0 | 0-5 |

#### 绩效数据

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 49 | 绩效分配金额 | mdnb_amountfield25 | 正整数 | 0 | ≥0 |
| 50 | 绩效补发金额 | mdnb_amountfield26 | 正整数 | 0 | ≥0 |
| 51 | 考核奖扣工资 | mdnb_amountfield27 | 数值 | 0 | 可正可负 |

#### 津贴补贴

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 52 | 井下折算调整工龄 | mdnb_decimalfield4 | 正整数 | 0 | ≥0 |
| 53 | 值班津贴标准 | mdnb_amountfield3 | 正整数 | 0 | ≥0 |
| 54 | 入井津贴标准 | mdnb_amountfield58 | 正整数 | 0 | 0或45或60 |
| 55 | 保留工资 | mdnb_amountfield1 | 正整数 | 0 | ≥0 |
| 56 | 补差工资 | mdnb_amountfield64 | 正整数 | 0 | ≥0 |
| 57 | 高温高空津贴 | mdnb_amountfield30 | 正整数 | 0 | ≥0 |
| 58 | 野外施工津贴 | mdnb_amountfield31 | 正整数 | 0 | ≥0 |
| 59 | 有毒有害津贴 | mdnb_amountfield32 | 正整数 | 0 | ≥0 |
| 60 | 电焊津贴 | mdnb_amountfield33 | 正整数 | 0 | ≥0 |
| 61 | 回族伙食津贴 | mdnb_amountfield34 | 正整数 | 0 | ≥0 |
| 62 | 交通补助 | mdnb_amountfield35 | 正整数 | 0 | ≥0 |
| 63 | 通讯补助 | mdnb_amountfield36 | 正整数 | 0 | ≥0 |
| 64 | 其他津补贴 | mdnb_amountfield38 | 正整数 | 0 | ≥0 |
#### 计件工资

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 65 | 工分 | mdnb_decimalfield200 | 正整数 | 0 | ≥0 |
| 66 | 单价 | mdnb_decimalfield300 | 浮点数 | 0 | 保留五位小数,≥0 |
| 67 | 计件工资 | mdnb_amountfield300 | 浮点数 | 0 | 保留两位小数,≥0 |

#### 奖励

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 68 | 奋斗者专项激励 | mdnb_amountfield40 | 正整数 | 0 | ≥0 |
| 69 | 贡献收入 | mdnb_amountfield41 | 正整数 | 0 | ≥0 |

#### 扣罚工资

| 序号 | 字段名称 | Excel字段名 | 数据类型 | 默认值 | 说明 |
|------|----------|-------------|----------|--------|------|
| 70 | 扣罚工资（补扣工资） | mdnb_amountfield39 | 数值 | 0 | 可正可负 |
| 71 | 扣罚工资备注 | mdnb_textfield6 | 字符串 | 空 | - |

## 数据验证规则

### 格式验证
1. **员工编码**: 必须唯一，不能重复
2. **身份证号**: 必须符合18位身份证号码格式
3. **数值字段**: 必须为有效数字，不能包含字母或特殊符号（除小数点外）
4. **日期字段**: 如有日期字段，必须使用标准日期格式（YYYY-MM-DD）
5. **枚举值**: 字段值必须在允许的枚举范围内

### 业务验证
1. **工龄字段**: 入井年限不能大于集团工龄
2. **考勤工数**: 各类假期工数之和不能超过31天
3. **系数范围**: 岗位系数必须在1.0-6.0之间
4. **津贴标准**: 入井津贴标准只能是0、45、60

### 错误处理
- **必填字段缺失**: 系统会提示"缺少必填字段: [字段名]"
- **数据类型错误**: 系统会提示"字段 [字段名] 数据类型不正确，期望: [类型]"
- **重复数据**: 系统会提示"员工编码 [编码] 重复"
- **验证失败**: 系统会提示"[字段名] 验证失败: [失败原因]"

## 导入流程

1. **文件选择**: 用户选择符合格式要求的Excel文件
2. **格式验证**: 系统验证文件格式、编码、大小
3. **字段映射**: 系统根据Excel列标题自动映射到系统字段
4. **数据验证**: 系统对每行数据进行格式和业务验证
5. **结果展示**: 系统显示导入结果，包括成功行数、失败行数、错误详情
6. **数据确认**: 用户确认导入数据，系统正式存储

## 示例数据

参考 `employee-data-template.xlsx` 文件，该文件包含了完整的字段示例和样例数据。

## 注意事项

1. **字段顺序**: Excel中字段的顺序可以任意排列，系统会根据列标题自动识别
2. **列标题**: Excel中的列标题必须与本规范中的"Excel字段名"完全一致（区分大小写）
3. **空值处理**: 可选字段可以为空，系统会使用默认值
4. **数据更新**: 重复导入相同员工编码时，系统会提示是否覆盖现有数据
5. **批量导入**: 建议单次导入数据量不超过10000条记录，以确保处理性能
