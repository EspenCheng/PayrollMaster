# PayrollMaster 薪资管理系统 - 计算逻辑文档

**创建日期**: 2025-11-08
**状态**: 待完善
**说明**: 此文档详细说明薪资核算中各项数据的计算公式和业务逻辑

## 计算逻辑概述

### 薪资计算流程
薪资计算按照以下顺序进行，确保计算结果的准确性和一致性：

1. **基础数据验证** - 验证员工基础信息和考勤数据的完整性和有效性
2. **日资计算** - 根据岗位工资基值、岗位系数等计算基础日薪标准
3. **基础薪资计算** - 计算岗位工资、井下职业健康岗位工资、年功工资
4. **加班工资计算** - 基于日薪标准和加班工数计算加班工资
5. **带薪假工资计算** - 计算各类带薪假期的工资待遇
6. **辅助工资计算** - 计算各类津贴、补贴和辅助工资项目
7. **绩效工资计算** - 计算计件工资和绩效工资合计
8. **应领工资计算** - 汇总所有收入项目得出应领工资
9. **实领工资计算** - 扣除个人代扣代缴项目，计算最终实领工资
10. **结果验证** - 验证计算结果的合理性和合规性

### 计算特点
- **日薪制优先**: 大部分计算基于日薪标准，确保公平性
- **分项计算**: 各项工资项目独立计算，便于核对和管理
- **政策导向**: 严格按照国家劳动法规和企业内部政策执行
- **数据验证**: 每个计算步骤都包含数据验证和异常处理
- **结果可控**: 计算结果可追溯、可验证、可调整

### 关键计算要素
- **日薪标准**: 作为加班工资、带薪假工资等计算的基础
- **工资薪制**: 区分日薪制和月薪制，采用不同计算方式
- **工龄系数**: 年功工资和病假工资计算的重要依据
- **考勤数据**: 各项工资计算的核心输入数据
- **政策标准**: 津贴补贴、社保扣款等按政策标准执行


## 基础薪资计算

### 1.日资计算
```
日资 = 岗位工资基值 × 岗位系数 × 专业技术人员岗位调节系数 ÷ 基础制度日工数
```

**变量说明**:
- `dailySalary` - 日资（计算结果）
- `BASEWORKDAYS` - 基础制度日工数（常量）
- `positionSalaryBase` - 岗位工资基值（输入数据,默认700）
- `positionCoefficient` - 岗位系数（输入数据）
- `techPositionAdjustCoefficient` - 专业技术人员岗位调节系数（输入数据）

**计算规则**:
- 岗位工资基值默认为700，岗位系数介于1.0-6.0之间，岗位系数只有1位小数
- 计算结果保留2位小数

### 2. 岗位工资计算
```
岗位工资按照工资薪制分两种计算方式：
工资薪制为日薪：岗位工资 = 日资 × 制度工日工数
工资薪制为月薪：岗位工资 = 岗位工资基值 × 岗位系数 × 专业技术人员岗位调节系数
```

**变量说明**:
- `positionSalary` - 岗位工资（计算结果）
- `BASEWORKDAYS` - 基础制度日工数（常量）
- `dailySalary` - 日资（第1步计算结果）
- `positionSalary` - 工资薪制（输入数据）
- `systemWorkDays` - 制度工日工数（输入数据）

**计算规则**:
- 工资薪制只能是日薪或月薪，不能为其他
- 制度工日工数必须大于等于0
- 计算结果保留2位小数

### 3. 井下职业健康岗位工资计算
```
井下职业健康岗位工资 = 岗位工资 × (井下职业健康岗位工资系数 - 1)
```

**变量说明**:
- `undergroundHealthSalary` - 井下职业健康岗位工资（计算结果）
- `positionSalary` - 岗位工资（上一步计算结果）
- `undergroundHealthCoefficient` - 井下职业健康岗位工资系数（输入数据）

**计算规则**:
- 井下职业健康岗位工资系数默认为1，只能是[1, 1.2, 1.4, 1.6, 1.8]其中之一
- 如果系数为1，则该项工资为0

### 4. 年功工资计算
```
年功工资标准为新标准：年工工资 = (集团工龄 + 井下折算调整工龄) × 年功新标准
年功工资标准为旧标准：年工工资 = (集团工龄 + 井下折算调整工龄) × 年功旧标准
```

**变量说明**:
- `senioritySalary` - 年功工资（计算结果）
- `senioritySalaryStandard` - 年功工资标准（输入数据）
- `groupWorkYears` - 集团工龄（输入数据）
- `undergroundAdjustedYears` - 井下折算调整工龄（输入数据）

**计算规则**:
- 井下折算调整工龄可以为0（新员工）
- 年功标准根据以下表格计算

| 集团工龄 | 年功新标准 | 年功旧标准 |
|---------|--------|-------|
| 01-05 | 80  | 10 |
| 06-10 | 90  | 10 |
| 11-15 | 100 | 12 |
| 16-20 | 100 | 14 |
| 21-25 | 100 | 16 |
| 26-30 | 100 | 18 |
| 31及以上 | 100 | 20 |

### 5. 加班工资计算
```
加班工资合计 = 日资 × 公休日出勤工数 × 2 + 日资 × 节假日出勤工数 × 3
```

**变量说明**:
- `overtimeSalaryTotal` - 加班工资合计（计算结果）
- `dailySalary` - 日资（第1步结算结果）
- `weekendWorkDays` - 公休日出勤工数（输入数据）
- `holidayWorkDays` - 节假日出勤工数（输入数据）

**计算规则**:
- 加班工资合计保留2位小数
- 公休日出勤工数、节假日出勤工数大于等于0

## 带薪假工资计算

### 1. 各类假期工资计算

#### (1)年休假工资
```
年休假工资 = 日资 × 带薪年休假
```
#### (2)培训工资
```
培训工资 = 日资 × 学习工数
```
#### (3)婚假工资
```
婚假工资 = 日资 × 婚假
```

#### (4)探亲假工资
```
探亲假工资 = 日资 × 探亲假
```

#### (5)有资产假工资
```
有资产假工资 = 日资 × 有资产假
```

#### (6)丧假工资
```
丧假工资 = 日资 × 丧假
```
 
#### (7)病假工资
```
病假工资 = 日资 × 病假 × 病假工资系数
```
**说明**: 病假工资系数根据集团工龄确定，具体如下表格：
| 集团工龄 | 病假工资系数 |
|---------|-------------|
| 01-04 | 0.6 |
| 05-09 | 0.7 |
| 10-14 | 0.8 |
| 15-20 | 0.9 |
| 20及以上 | 1 |

#### (8)其他有资假工资
```
其他有资假(提报数据)
其他有资假工资(提报数据)
```

### 2.有资假备注
```
有资假备注(提报数据)
```

### 3.出勤工数计算
```
出勤工数 = 制度工日工数 + 公休日出勤工数 + 节假日出勤工数
```

**变量说明**:
- `attendanceDays` - 出勤工数（计算结果）
- `systemWorkDays` - 制度工日工数（输入数据）
- `weekendWorkDays` - 公休日出勤工数（输入数据）
- `holidayWorkDays` - 节假日出勤工数（输入数据）

### 4.有资假工数
```
有资假工数 = 带薪年休假 + 学习工数 + 婚假 + 探亲假 + 有资产假 + 丧假 + 病假 + 其他有资假
```

### 5. 带薪假类工资合计
```
婚丧产探伤工资 = 培训工资 + 婚假工资 + 探亲假工资 + 有资产假工资 + 丧假工资
带薪假类工资合计 = 年休假工资 + 婚丧产探伤工资 + 病假工资 + 其他有资假工资
```

## 辅助工资计算

### 1. 下井津贴计算
```
下井津贴 = 下井工数 × 入井津贴标准
```

**变量说明**:
- `undergroundAllowance` - 下井津贴（计算结果）
- `undergroundDays` - 下井工数（输入数据）
- `undergroundAllowanceStandard` - 入井津贴标准（输入数据）

### 2. 夜班津贴计算
```
夜班津贴 = 前夜班工数 × 前夜班津贴标准 + 后夜班工数 × 后夜班津贴标准
```

**变量说明**:
- `nightShiftAllowance` - 夜班津贴（计算结果）
- `nightShiftDays` - 前夜班工数（输入数据）
- `lateNightShiftDays` - 后夜班工数（输入数据）
- `EARLYNIGHTSUBSIDY` - 前夜班津贴标准（常量）
- `LATENIGHTSUBSIDY` - 后夜班津贴标准（常量）

### 3. 值班津贴计算
```
值班津贴 = 值班天数 × 值班津贴标准
```

**变量说明**:
- `dutyAllowance` - 值班津贴（计算结果）
- `onDutyDays` - 值班天数（输入数据）
- `dutyAllowanceStandard` - 值班津贴标准（输入数据）

### 4. 其他津贴补贴
各类专项津贴直接使用输入数据：
- 高温高空津贴 (`highAltitudeAllowance`)
- 野外施工津贴 (`fieldWorkAllowance`)
- 有毒有害津贴 (`hazardousAllowance`)
- 电焊津贴 (`weldingAllowance`)
- 回族伙食津贴 (`halalFoodAllowance`)
- 交通补助 (`transportAllowance`)
- 通讯补助 (`communicationAllowance`)
- 其他津补贴 (`otherAllowances`)

### 5.其他辅助工资
其他辅助工资直接使用输入数据：
- 保留工资（`retainedSalary`）
- 补差工资 （`supplementSalary`）

### 6.辅助工资合计
```
辅助工资合计 = 保留工资 + 补差工资 + 下井津贴 + 夜班津贴 + 值班津贴 + 高温高空津贴 +
               野外施工津贴 + 有毒有害津贴 + 电焊津贴 + 回族伙食津贴 + 交通补助 + 通讯补助 + 其他津补贴
```

## 绩效工资计算

### 1.计件工资
```
计件工资 = 工分 × 单件
```

**变量说明**:
- `pieceworkSalary` - 计件工资（计算结果）
- `workPoints` - 工分（输入数据）
- `unitPrice` - 单价（输入数据）

**计算规则**:
- 工分为正整数，不可为负数
- 单价为浮点数，保留5位小数
- 计件工资为浮点数，保留2位小数

### 2. 绩效工资合计
```
绩效工资合计 = 绩效分配金额 + 绩效补发金额 + 考核奖扣工资 + 计件工资
```

**变量说明**:
- `performanceSalaryTotal` - 绩效工资合计（计算结果）
- `pieceworkSalary` - 计件工资（上一步计算结果）
- `performanceAllocation` - 绩效分配金额（输入数据）
- `performanceSupplement` - 绩效补发金额（输入数据）
- `assessmentDeduction` - 考核奖扣工资（输入数据，可为负数）

**计算规则**:
- 考核奖扣工资可以为正数（奖励）或负数（扣罚）
- 绩效工资合计不可以为负数，需要提示


## 应领工资计算

### 应领工资构成
```
应领工资 = 岗位工资 + 井下职业健康岗位工资 + 年功工资 + 加班工资合计 + 带薪假类工资合计 +
               辅助工资合计 + 绩效工资合计 + 奋斗者专项激励 + 贡献收入 + 扣罚工资（补扣工资）
```


## 实领工资计算

### 1. 个人代扣代缴合计
```
个人代扣代缴合计 = 养老保险（个人） + 医疗保险（个人） + 失业保险（个人） +
               住房公积金（个人） + 企业年金（个人） + 互助金（个人）
```

### 2. 实领工资
```
实领工资 = 应领工资 - 个人代扣代缴合计 - 个人所得税 +
           独生子女费 + 女工卫生费
```

**计算规则**:
- 个人代扣代缴合计不可大于应领工资
- 实领工资为浮点数，不可小于0，保留2位小数

## 注意事项:
1. 计算顺序必须严格按照流程执行
2. 每个计算步骤都需要进行数据验证
3. 异常情况需要记录日志并通知相关人员
4. 定期检查计算逻辑的准确性和合规性
